<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <title>Folha de Frequência — {{ func.nome }} ({{ mes_ref|date:"m/Y" }})</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <style>
    :root{
      --ink:#0f172a; --muted:#64748b; --g1:#f30c80; --g2:#f30c80;
      --base:10.9px;              /* fontes reduzidas p/ caber em 1 folha */
      --cell-pad:.22rem .28rem;   /* padding compacto */
      --sig-h:18px;               /* altura da linha de preenchimento */
    }
    html{ font-size:var(--base); }
    body{ background:#f6f8fb; color:var(--ink); }

    /* Página / papel no mesmo estilo */
    .paper{ max-width:1024px; margin:12px auto; background:#fff; border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 10px 22px rgba(17,24,39,.08); }
    .brand{ background:linear-gradient(90deg,var(--g1),var(--g2)); color:#fff; border-top-left-radius:12px; border-top-right-radius:12px; padding:8px 12px; }
    .p-wrap{ padding:10px 12px 12px; }
    .muted{ color:var(--muted); }

    /* Tabela única (uma coluna) */
    table{ width:100%; border-collapse:collapse; }
    .table th, .table td{ padding:var(--cell-pad); border-top:1px solid #e5e7eb; vertical-align:middle; }
    .table thead th{ font-size:.7rem; text-transform:uppercase; letter-spacing:.04em; color:#64748b; border-top:0; }
    .mini{ font-size:.82rem; color:var(--muted); }

    /* Linhas p/ escrita à mão */
    .sigline{ height:var(--sig-h); border-bottom:1px solid #cbd5e1; }
    .sigcell{ min-width:54px; }

    /* Fim de semana */
    .sat{ background:#eef2ff; }
    .sun{ background:#fee2e2; }

    /* Cabeçalho compacto */
    .tbl-head td{ padding:.32rem .4rem; }

    /* Logo ao lado do nome */
    .logo-emp{
      max-height:28px; width:auto;
      border:1px solid #e5e7eb; border-radius:6px; padding:2px;
      background:#fff;
    }

    @media print{
      @page{ size:A4 portrait; margin:8mm; }
      body{ background:#fff; }
      .paper{ box-shadow:none; border:0; margin:0; border-radius:0; }
      .brand{ border-radius:0; }
      .d-print-none{ display:none !important; }
      .table th, .table td{ padding:.2rem .26rem; }
      .sigline{ height:16px; }
      .logo-emp{ max-height:24px; }
    }
  </style>
</head>
<body>

<div class="paper">
  <div class="brand d-flex justify-content-between align-items-center">
    <div>
      <div class="fw-bold">Folha de Frequência</div>
      <div class="text-white-50 small">{{ mes_ref|date:"F \d\e Y" }}</div>
    </div>
    <button class="btn btn-light btn-sm d-print-none" onclick="window.print()">Imprimir</button>
  </div>

  <div class="p-wrap">
    <!-- Cabeçalho: dados da Empresa (com logo) e do Funcionário -->
    <table class="table tbl-head mb-2">
      <tbody>
        <tr>
          <td style="width:65%">
            <div class="d-flex align-items-center gap-2">
              {% if empresa_logo_url %}
                <img src="{{ empresa_logo_url }}" alt="Logo {{ empresa_nome }}" class="logo-emp">
              {% endif %}
              <div>
                <div class="fw-semibold">
                  {{ empresa_nome|default:"—" }}
                  {% if empresa_razao %}<span class="mini"> • {{ empresa_razao }}</span>{% endif %}
                </div>
                <div class="mini">
                  {% if empresa_cnpj %}CNPJ: {{ empresa_cnpj }}{% endif %}
                  {% if empresa_ie %} • IE: {{ empresa_ie }}{% endif %}
                </div>
              </div>
            </div>
          </td>
          <td style="width:35%">
            <div class="fw-semibold">Funcionário</div>
            <div class="mini">
              {{ func.nome }}
              {% if func.cpf %} • CPF: {{ func.cpf }}{% endif %}
              • Jornada: {{ jornada_label }} • Almoço: {{ almoco_label }}
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- TABELA ÚNICA (UMA COLUNA); domingo mostra "-" nos horários -->
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th style="width:7%">Dia</th>
            <th style="width:14%">Semana</th>
            <th style="width:12%">E (M)</th>
            <th style="width:12%">S (M)</th>
            <th style="width:12%">E (T)</th>
            <th style="width:12%">S (T)</th>
            <th style="width:31%">Assinatura</th>
          </tr>
        </thead>
        <tbody>
          {% for l in linhas %}
          <tr class="{% if l.is_sat %}sat{% elif l.is_sun %}sun{% endif %}">
            <td class="fw-semibold">{{ l.dia }}</td>
            <td>{{ l.label }}</td>

            {% if l.is_sun %}
              <!-- Domingo: colocar "-" nos 4 horários -->
              <td class="text-center text-muted">-</td>
              <td class="text-center text-muted">-</td>
              <td class="text-center text-muted">-</td>
              <td class="text-center text-muted">-</td>
              <td class="text-center fw-semibold">DOMINGO</td>
            {% else %}
              <!-- Demais dias: horários em branco (linhas para preencher) -->
              <td class="sigcell"><div class="sigline"></div></td>
              <td class="sigcell"><div class="sigline"></div></td>
              <td class="sigcell"><div class="sigline"></div></td>
              <td class="sigcell"><div class="sigline"></div></td>
              <td class="sigcell"><div class="sigline"></div></td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Rodapé (assinaturas) -->
    <table class="table mt-1">
      <tbody>
        <tr>
          <td style="width:50%; text-align:center;">
            <div class="sigline"></div>
            <div class="mini mt-1">Assinatura do(a) Funcionário(a)</div>
          </td>
          <td style="width:50%; text-align:center;">
            <div class="sigline"></div>
            <div class="mini mt-1">Assinatura da empresa</div>
          </td>
        </tr>
        <tr>
          <td colspan="2" class="mini">
            Local/Data: ____________________________________________
          </td>
        </tr>
      </tbody>
    </table>

    <div class="d-flex justify-content-end gap-2 d-print-none">
      <a class="btn btn-outline-secondary" href="{% url 'camisas:freq_resumo' %}?func={{ func.id }}&mes={{ mes_str }}">Voltar</a>
      <button class="btn btn-primary" onclick="window.print()">Imprimir</button>
    </div>
  </div>
</div>

</body>
</html>
